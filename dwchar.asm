DW-char assembly
initialize

C700 78 SEI
C701 A9 31 LDA 1$31 ;SHIFT CHAR
C703 85 01 STA $01 ; ROM IN
C705 AO 00 LDY 1$00
C707 84 FA STY $FA
C709 84 FC STY $FC
C70B 84 FE STY $FE
C70D A9 00 LDA tSDO ;ORIG. CHAR
C70F 85 FB STA $FB ; ADDR. HI
C711 A9 EO LDA tSEO ;DW-CHARSET
C713 85 FO STA $FD ; ADDR. HI
C715 AD 12 C7 LDA $C712 ;CUSTOMIZED
C718 18 CLC ; CHARS AT
C719 69 04 ADC #$04 ; ( $C712) +
C71B 85 FF STA $FF ; $0400
copy chars
C710 A2 04 LOX #$04 ;4 TIMES
C71F Bl FA LDA ($FA),Y;DO LOOP
C721 91 FC STA ($FC) ,Y
C723 91 FE STA ($FE) ,Y
C725 C8 INY ;COPY CHARS
C726 00 F7 BNE $C71F ; FROM ROM
C728 E6 FB INC $FB ; TO RAM
C72A E6 FD INC $FO
C72C E6 FP INC $FP
C72E CA OEX
C72F 00 EE BNE $C71F ;ENDLOOP
C731 AD 12 C7 LDA $C712
C734 85 FB STA $FB
C736 69 04 AOC 1$04
C738 85 FO STA $FD
C73A 69 02 AOC 1$02
C73C 85 FF STA $FF
make chars douple wide
C73E Bl FA LDA ($FA),Y;DO LOOP
C740 20 75 C7 JSR $C775 ;WIDEN CHAR
C743 AS 03 LDA $03 ;LEFT SIDE
C745 91 FC STA ( $FC) , Y; OF CHAR
C747 AS 02 LDA $02 ;RIGHT SIDE
C749 91 FE STA ( $FE) , Y; OF CHAR
C74B C8 INY
C74C DO FO BNE $C73E ;ENDLOOP
C74E AO OE C7 LOA $C70E
C751 18 CLC
C752 69 08 ADC #$08 ;CONTROL:
C754 85 FB STA $FB ; OO=UPPER,
C756 AO 12 C7 LDA $C712 ; 08=LOWER
C759 69 08 ADC #$08 ; CASE
C75B 85 FO STA $FD
C75D A2 08 LOX #$08 ;8 TIMES
C75F Bl FA LOA ($FA),Y;DO LOOP
C761 91 FC STA ($FC) ,Y
C763 C8 INY ;COPY PROG.
C764 DO F9 BNE $C75F ; MODE CHAR
C766 E6 FB INC $FB ; SET TO
C768 E6 FD INC $FD ; RAM
C76A CA DEX
C76B DO F2 BNE $C75F ;ENDLOOP
C76D A9 37 LOA 1$37 ;SHIFT CHAR
C76F 85 01 STA $01 ; ROM OUT
C771 58 CLI ;CHARS NOW
C772 4C EO C7 JMP $C7EO ; READY
sub: widen one char
C775 A2 08 LOX #$08 ; 8 TIMES
C777 2A ROL ;00 LOOP
C778 08 PHP
C779 26 02 ROL $02 ;WIDEN CHAR
C77B 26 03 ROL $03 ;RESULTS AT
C770 28 PLP ; $02 & $03
C77E 26 02 ROL $02
C780 26 03 ROL $03
C782 CA DEX
C783 00 F2 BNE $C777 ;ENDLOOP
C785 60 RTS 

handle NMI & break
C786 48 PHA NMI
C787 SA TXA ROUTINE
C788 48 PHA AT $C786,
C789 98 TYA BREAK AT
C78A 48 PHA $C78B
C78B 20 A3 FO JSR $FOA3 RESET I/0
C78E 20 15 FO JSR $F015 R. VECTORS
C791 20 EO C7 JSR $C7EO HOUSEKEEP
C794 6C 02 AO JMP ($A002) BASICSTART
sub: reset screen, VIC, vectors etc.
C797 A9 C8 LOA 1$C8 ;SCREEN AT
C799 80 88 02 STA $0288 ; scaoo
C79C 20 18 ES JSR $E518 ;RESET VIC
C79F A9 94 LOA #$94 ;VIDEO BANI<
C7Al 80 00 00 STA $0000 ; IS #3
C7A4 A9 2A LOA #$2A ;CHARS AT
C7A6 80 18 DO STA $0018 , SEOOO
C7A9 A9 8B LDA f$8B ;VECTORS : C7AB 80 16 03 STA $0316 ; NMI=
C7AE A9 86 LDA 1$86 ; $C786
C780 80 18 03 STA $0318 ; BREAK=
C7B3 A9 C7 LOA 1$C1 ; $C78B
C7B5 80 17 03 STA $0317 ; IBSOUT=
C7B8 80 19 03 STA $0319 ; $C7C4
C7BB 80 27 03 STA $0327
C7BE A9 C4 LDA l$C4
C7CO 80 26 03 STA $0326 ;EVERYTHING
C7C3 60 RTS ; IN ORDER 

new print routine
C7C4 48 PHA STORE CHAR
C7C5 20 CA Fl JSR $FlCA PRINT IT
C7C8 AO 18 00 LDA $0018 DW-MODE?
C7CB 29 02 ANO 1$02
C7CD DO 04 BNE $C7D3 NO,RETURN
C7CF A5 C7 LOA $C7 YES, RVS?
C7Dl 00 02 BNE $C7D5 YES, CONT
C7D3 68 PLA NO, RETURN
C704 60 RTS
C705 68 PLA RESTORE
C7D6 C9 40 CMP 1$40 CHAR<"@"?
C708 90 05 BCC $C7DF YES,RETURN
C7DA 09 20 ORA 1$20 NO, SHIFT&
C70C 20 CA Fl JSR $Fl CA PRINT IT
C70F 60 RTS NOW READY

housekeeping
C7EO 20 97 C7 JSR $C797 RESET ALL
C7E3 EE 20 00 INC $0020 BORDER
C7E6 OE 21 DO ASL $0021 SCREEN
C7E9 A9 FO LOA ISFO PRINT THE
C7EB AO C7 LDY #$C7 STRING AT
C7ED 4C lE AB JMP $AB1E $C7FO:
C7FO 11 05 44 57 " .. dw" "dw-char! "
C7F4 20 43 48 41 " -cha"
C7F8 52 21 90 00 " r! .. ..
.END
